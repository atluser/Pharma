ScrollableTablePanel {	
	DataRow currentRow;
	
	BackgroundButton btnNext=new BackgroundButton();
	
	int labelColumnSize=11;//dimensione % label column
	String labelAlign="halign=left";
	String controlAlign="halign=left,hfill=fill";
	Screens.OrderEntry.OrderHeaderScreen scr=null;
	
	Popover poPick=new Popover();
	Panels.PickLOVStickyTablePanel pnlPick = new Panels.PickLOVStickyTablePanel();
	Label lblPickTitle=new Label();
	Action actClosePop=new Action();
	//AnchorPosition ap=new AnchorPosition();
	
	Label lblCode=new Label();
	Label lblOrderDate=new Label();
	Label lblType=new Label();
	//Label lbl03=new Label();
	Label lblAccountName=new Label();
	Label lblPriceList=new Label();
	Label lblStatus=new Label();
	Label txtShipDate1=new Label();
	Label txtShipDate2=new Label();	
	Label txtShipDate3=new Label();
	Label lblPaymentMethod=new Label();
	Label lblNote=new Label();
	
	Label lblAmount1=new Label();
	Label lblAmount2=new Label();
	Label lblDiscount=new Label();
	
	Label txtCode=new Label();
	//TextModel mdlCode=new TextModel();
	
	Label txtAccount=new Label();
	//TextModel mdlAccount=new TextModel();
	
	Label txtStatus=new Label();
	//TextModel mdlStatus=new TextModel();
	
	//BackgroundButton btnPriceList=new BackgroundButton();
	Label txtPriceList=new Label();
	
	BackgroundButton btnPaymentMethod=new BackgroundButton();
	BackgroundButton lblShipDate1=new BackgroundButton();
	BackgroundButton lblShipDate2=new BackgroundButton();		
	BackgroundButton lblShipDate3=new BackgroundButton();
	
	Popover popShipDate1=new Popover();
	Popover popShipDate2=new Popover();
	Popover popShipDate3=new Popover();
	
	Label txtType=new Label();
	//TextModel mdlType=new TextModel();
	
	Label txtDate=new Label();
	DateFormatModel mdlDate=new DateFormatModel();
	
	DateBox dtShipDate1=new DateBox();
	DateFormatModel mdlShipDate1=new DateFormatModel();
	
	DateBox dtShipDate2=new DateBox();
	DateFormatModel mdlShipDate2=new DateFormatModel();
	
	DateBox dtShipDate3=new DateBox();
	DateFormatModel mdlShipDate3=new DateFormatModel();
	
	TextArea txtNote=new TextArea();
	TextModel mdlNote=new TextModel();
	
	
	FormPanel formPanel01=new FormPanel();
	FormPanel formPanel02=new FormPanel();
	
	Styles.FormStyle style = new Styles.FormStyle();
	//Font titlefnt;
	callback onCreate(Container c){
	//	setUpPickPopover();
		setLabel();
		setModel();
		
		Font txtfnt=new Font();
		txtfnt.setFamily("Arial");
		txtfnt.setSize(22);		
		txtfnt.setBold();
		//titlefnt=txtfnt.createCopy();
		
		//tablepanel
		TablePanel mainTP=new TablePanel();
											
		//sezione anagrafica		
		setInsets(8,8,8,8);						
		Label lblTitle1=new Label();
		lblTitle1.setText("Dettaglio Ordine");
		lblTitle1.setFont(txtfnt);
		mainTP.add(lblTitle1,"halign=center");
		mainTP.startNewRow();//1
		setFormPanel01();
		setFormPanel02();
		formPanel01.setBackground(Background.createColorRoundedBackground( Colors.BackgroundGray));		
		//add in table panel
		mainTP.add(formPanel01,"halign=center,hfill=fill");		
		
		//setRowHeight(3,Sizing.PREFERRED,3);		
		
		//sezione indirizzo
		mainTP.startNewRow();//2
		mainTP.add(new Separator(),"");
		mainTP.setRowHeight(2,Sizing.PERCENTS,3);
		mainTP.startNewRow();//3
		Label lblTitle2=new Label();
		lblTitle2.setText("Consegna e Pagamento");
		lblTitle2.setFont(txtfnt);
		mainTP.add(lblTitle2,"halign=center");
		mainTP.startNewRow();//4
		formPanel02.setBackground(Background.createColorRoundedBackground( Colors.BackgroundGray));
		mainTP.add(formPanel02,"halign=center,hfill=fill");
		mainTP.startNewRow();//5		
		mainTP.add(new Separator(),"");
		mainTP.setRowHeight(5,Sizing.PERCENTS,3);
		mainTP.startNewRow();//6
		btnNext.setText("Configura");
		btnNext.setLeftSpacing(56);
		btnNext.setBackground(Background.create9PartImageRectangleBackground (Images.VodafoneImages.ImgOrderItemsList , 50 , 30 , 0 , 0 ));
		
		mainTP.add(btnNext,"hfill=fill");			
		mainTP.startNewRow();//7		
		mainTP.add(new Separator(),"");
		mainTP.setRowHeight(7,Sizing.PERCENTS,3);
		
				
		mainTP.setColumnWidth(0,Sizing.PIXELS,550);
		add(mainTP,"halign=center,vfill=fill");
		setColumnWidth(0,Sizing.PERCENTS,100);
	}
	
	callback applyVisualStyle(Widget widget, StyleReceptor styleReceptor){		
		styleReceptor.applyVisualStyle(style);
	}
	
	
	void setLabel(){
		Font txtfnt=new Font();
		txtfnt.setFamily("Arial");
		txtfnt.setSize(16);
		txtfnt.setBold();
											
		lblCode.setText("Nr. Ordine");
		lblCode.setForeColor(Color.create(189,0,0));		
		lblOrderDate.setText("Data Ordine");
		lblOrderDate.setForeColor(Color.create(189,0,0));		
		lblType.setText("Tipo");
		lblType.setForeColor(Color.create(189,0,0));					
		lblAccountName.setText("Cliente");
		lblAccountName.setForeColor(Color.create(189,0,0));				
		lblPriceList.setText("Listino");
		lblPriceList.setForeColor(Color.create(189,0,0));								
		lblStatus.setText("Stato");
		lblStatus.setForeColor(Color.create(189,0,0));
		
		lblShipDate1.setText("1° Data Consegna");
		lblShipDate1.setForeColor(Color.create(189,0,0));
		lblShipDate2.setText("2° Data Consegna");
		lblShipDate3.setText("3° Data Consegna");
		lblPaymentMethod.setText("Metodo di pagamento");
		lblNote.setText("Note");
		
		lblAmount1.setText("Totale Ordine Lordo");
		lblAmount2.setText("Totale Ordine Netto");
		lblDiscount.setText("Totale Sconto %");
		popShipDate2.add(dtShipDate2,null);		
		popShipDate3.add(dtShipDate3,null);
		
		lblShipDate1.setBackground(Background.createColorRoundedBackground ( Colors.BackgroundGray )) ;
		lblShipDate2.setBackground(Background.createColorRoundedBackground ( Colors.BackgroundGray )) ;
		lblShipDate3.setBackground(Background.createColorRoundedBackground ( Colors.BackgroundGray )) ;
								
	}
	
	void setModel(){		
		Font txtfnt=new Font();
		mdlDate.addField(vObjOrder.OrderDate);
		mdlShipDate1.addField(vObjOrder.Order1stDeliveryDate);
		mdlShipDate2.addField(vObjOrder.Order2ndDeliveryDate);
		mdlShipDate3.addField(vObjOrder.Order3rdDeliveryDate);
		mdlNote.addField(vObjOrder.OrderNote);
		
		txtNote.setDataModel(mdlNote);
		txtDate.setDataModel(mdlDate);
		
		dtShipDate1.setDataModel(mdlShipDate1);
		dtShipDate2.setDataModel(mdlShipDate2);
		dtShipDate3.setDataModel(mdlShipDate3);		
		
		mdlShipDate1.setStyle(DateStyles.DATE_MEDIUM );
		txtShipDate1.setDataModel(mdlShipDate1);
		mdlShipDate2.setStyle(DateStyles.DATE_MEDIUM );
		txtShipDate2.setDataModel(mdlShipDate2);		
		mdlShipDate3.setStyle(DateStyles.DATE_MEDIUM );
		txtShipDate3.setDataModel(mdlShipDate3);
	}
	
	
	void setFormPanel01(){ 
		formPanel01.add(lblCode,labelAlign,txtCode,controlAlign);
		formPanel01.add(lblOrderDate,labelAlign,txtDate,controlAlign);
		formPanel01.add(lblType,labelAlign,txtType,controlAlign);
		formPanel01.add(lblAccountName,labelAlign,txtAccount,controlAlign);
		formPanel01.add(lblPriceList,labelAlign,txtPriceList,controlAlign);
		formPanel01.add(lblStatus,labelAlign,txtStatus,controlAlign);		
		formPanel01.setControlColumnWidth(Sizing.PREFERRED, 1);
		formPanel01.setLabelColumnWidth(Sizing.PERCENTS,labelColumnSize);				 
	}
	
	void setFormPanel02(){ 
		formPanel02.add(lblShipDate1,labelAlign,txtShipDate1,controlAlign);
		formPanel02.add(lblShipDate2,labelAlign,txtShipDate2,controlAlign);
		formPanel02.add(lblShipDate3,labelAlign,txtShipDate3,controlAlign);
		formPanel02.add(lblPaymentMethod,labelAlign,btnPaymentMethod,controlAlign);
		formPanel02.add(lblNote,labelAlign,txtNote,controlAlign);						
	}
	
	void setRow(DataRow row){		
		currentRow=row;			
		txtCode.setText(vObjOrder.OrderCode.getStringValue(row));
		txtType.setText(vObjOrder.OrderType.getStringValue(row));
		txtAccount.setText(vObjOrder.AccountName.getStringValue(row));
		txtStatus.setText(vObjOrder.OrderStatus.getStringValue(row));
		
		mdlDate.setRow(row);
		
		mdlShipDate1.setRow(row);
		mdlShipDate2.setRow(row);
		mdlShipDate3.setRow(row);
		
		txtPriceList.setText(vObjOrder.OrderPriceList.getStringValue(row));
		btnPaymentMethod.setText(vObjOrder.OrderPaymentMode.getStringValue(row));
		
		mdlNote.setRow(row);
		
		refresh();
		
		
		
	}
	
	void save(){		
			vObjOrder.Order1stDeliveryDate.setDateValue(dtShipDate1.getDate(),currentRow);
			vObjOrder.Order2ndDeliveryDate.setDateValue(dtShipDate2.getDate(),currentRow);
			vObjOrder.Order3rdDeliveryDate.setDateValue(dtShipDate3.getDate(),currentRow);
			currentRow.applyUpdates();
		
	}
	
	/*
	callback btnNext onClick(Control c){
		Breadcrumb brdCrumb2=new Breadcrumb();
		brdCrumb2.setFocusedBackColor(Colors.MediumOrchid);
	  	brdCrumb2.setBackColor(Colors.MediumSlateBlue);
	  	brdCrumb2.setSelectedBackColor(Colors.Magenta);
	  	brdCrumb2.setSelectedForeColor(Colors.White);
	  	brdCrumb2.setText("Item");
		brdCrumb2.setValue("B");				
		scr.brdCrumbs.add(brdCrumb2);
		scr.brdCrumbs.navigateTo(1);
	}*/
	
	callback btnNext onClick(Control c){
		//salvo testata
		scr.saveRefreshSticky();
		Screens.OrderEntry.ListItemScreen scr1=new Screens.OrderEntry.ListItemScreen();
		//imposto testata
		scr1.orderCode=txtCode.getText();		
		scr1.init(txtCode.getText(),"0001");
		scr1.push(0,false);
		//scr.close();
	}
	
	callback lblShipDate1 onClick(Control c){		
		AnchorPosition anchor=new AnchorPosition();
		anchor.setAnchor(c);
		scr.showPopover(popShipDate1,true,anchor);
	}
	callback lblShipDate2 onClick(Control c){		
		AnchorPosition anchor=new AnchorPosition();
		anchor.setAnchor(c);
		scr.showPopover(popShipDate2,true,anchor);
	}
	callback lblShipDate3 onClick(Control c){						
		AnchorPosition anchor=new AnchorPosition();
		anchor.setAnchor(c);
		scr.showPopover(popShipDate3,true,anchor);
	}
	
	
	callback popShipDate2 onDismiss ( Screen owner , Popover popup ){
		
	} 
	
	
	/*
	
	callback btnCategoryPopup onClick(Control c){
		showPopup((BackgroundButton)c,mdlCategory,"CATEGORY","Categorie");		
	}
	
	callback btnRevenuePopup onClick(Control c){
		showPopup((BackgroundButton)c,mdlRevenue,"REVENUE","Fatturato");		
	}
	
	callback btnRatingPopup onClick(Control c){
		showPopup((BackgroundButton)c,mdlRating,"RATING","Rating");		
	}
	//SHOW POPUP
	
	void showPopup(BackgroundButton button,TextModel model, String type,String title){
		Popups.ProvincePopup province=new Popups.ProvincePopup();	
		province.btnPopup=button;
		province.mdlPickMap=model;
		province.lblTitle.setText(title);
		province.setQuery(vObjLOV.getLOV(type));
		province.TYPE=type;				
		scr.showPopup(province,Popup.POPUP_TYPE_FROM_BOTTOM, Sizing.PIXELS ,530 , Sizing.PREFERRED, 0,true,true);		 
		
	}
	
	void setUpPickPopover(){
		Font titlefnt=new Font();
		titlefnt.setFamily("Arial");
		titlefnt.setSize(22);
		titlefnt.setBold();
		
		poPick.setAutoDismiss(false);
		
		TitleBarStyle titleBarStyle=new TitleBarStyle();
		
		titleBarStyle.setFont(titlefnt);
		titleBarStyle.setBackColor(Colors.Gray);
		//titleBarStyle.setBackground(Background.create9PartImageRectangleBackground(Images.PopoverImages.ImgBlackBackground, 0, 0, 0, 0));
		titleBarStyle.setForeColor(Color.create(255,255,255));
		titleBarStyle.setTitleAlignment(HorizontalAlignmentType.RIGHT);
		
		//style.TitleBar.setFont(titlefnt);
		poPick.setTitleBarStyle(titleBarStyle);
		poPick.setSize( Sizing.PIXELS, 400, Sizing.PIXELS, 400);		
		//poPick.setBackground(Background.create9PartImageRectangleBackground(Images.PopoverImages.ImgBlackBackground, 0, 0, 0, 0));
		poPick.setBackColor(Colors.BackgroundGray);
		//poPick.setLeftTitleBarAction ( actClosePop ); 
		pnlPick.po=poPick;
				
		poPick.add(pnlPick, "hfill=fill,vfill=fill");		
		
	}
		
	callback actClosePop onRun(Action a){
		poPick.dismiss();
	} 
		*/	
}